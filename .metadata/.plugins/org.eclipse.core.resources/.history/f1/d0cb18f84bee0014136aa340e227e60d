package io.github.csrgxtu.GpsLocation;

import android.os.Bundle;
import android.support.v7.app.ActionBarActivity;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.Button;
import android.widget.TextView;

import com.baidu.location.BDLocation;
import com.baidu.location.BDLocationListener;
import com.baidu.location.LocationClient;
import com.baidu.location.LocationClientOption;
//假如用到位置提醒功能，需要import该类
//如果使用地理围栏功能，需要import如下类

public class MainActivity extends ActionBarActivity {
    private TextView locationInfoTextView = null;  
    private Button startButton = null;  
    private LocationClient locationClient = null;  
    private static final int UPDATE_TIME = 5000;  
    private static int LOCATION_COUTNS = 0;
    
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.example);
		
        locationInfoTextView = (TextView) this.findViewById(R.id.tv_loc_info);  
        startButton = (Button) this.findViewById(R.id.btn_start);
        
        locationClient = new LocationClient(this);
        
        LocationClientOption option = new LocationClientOption();
        option.setOpenGps(true);
        option.setCoorType("bd09ll");
        option.setProdName("GpsLocation");
        option.setScanSpan(UPDATE_TIME);
        locationClient.setLocOption(option);
        
        //注册位置监听器  
        locationClient.registerLocationListener(new BDLocationListener() {  
              
            @Override  
            public void onReceiveLocation(BDLocation location) {  
                // TODO Auto-generated method stub  
                if (location == null) {  
                    return;  
                }  
                StringBuffer sb = new StringBuffer(256);  
                sb.append("Time : ");  
                sb.append(location.getTime());  
                sb.append("\nError code : ");  
                sb.append(location.getLocType());  
                sb.append("\nLatitude : ");  
                sb.append(location.getLatitude());  
                sb.append("\nLontitude : ");  
                sb.append(location.getLongitude());  
                sb.append("\nRadius : ");  
                sb.append(location.getRadius());  
                if (location.getLocType() == BDLocation.TypeGpsLocation){  
                    sb.append("\nSpeed : ");  
                    sb.append(location.getSpeed());  
                    sb.append("\nSatellite : ");  
                    sb.append(location.getSatelliteNumber());  
                } else if (location.getLocType() == BDLocation.TypeNetWorkLocation){  
                    sb.append("\nAddress : ");  
                    sb.append(location.getAddrStr());  
                }  
                LOCATION_COUTNS ++;  
                sb.append("\n检查位置更新次数：");  
                sb.append(String.valueOf(LOCATION_COUTNS));  
                locationInfoTextView.setText(sb.toString());  
            }  
        }); 
	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}

	@Override
	public boolean onOptionsItemSelected(MenuItem item) {
		// Handle action bar item clicks here. The action bar will
		// automatically handle clicks on the Home/Up button, so long
		// as you specify a parent activity in AndroidManifest.xml.
		int id = item.getItemId();
		if (id == R.id.action_settings) {
			return true;
		}
		return super.onOptionsItemSelected(item);
	}
}
